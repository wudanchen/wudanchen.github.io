import{isDef as b,isiPad as S,isMobile as F,isSafari as L,isLinkHttp as D,ensureEndingSlash as P,entries as C,useLocaleConfig as $}from"@vuepress/helper/client";import{useScrollLock as E}from"@vueuse/core";import{defineComponent as T,shallowRef as v,ref as y,h as f,watch as R,onMounted as U,onUnmounted as _}from"vue";import{CancelFullScreenIcon as z,EnterFullScreenIcon as I}from"vuepress-shared/client";import"../styles/pdf.scss";import{withBase as N}from"vuepress/client";import{u as H}from"../useSize-S0-d2Qte.js";import{g as M}from"../getLink-DBmDl_2w.js";const m=e=>{console.error(`[PDF]: ${e}`)},j=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},k=e=>e instanceof HTMLElement?e:e==="string"?document.querySelector(e):document.body,B=e=>{let n=C(e).map(([o,r])=>o==="noToolbar"?`toolbar=${r?"0":"1"}`:`${encodeURIComponent(o)}=${encodeURIComponent(r)}`).join("&");return n&&(n=`#${n.slice(0,n.length-1)}`),n},h=(e,n,o,r,a)=>{j(n);const d=`${e==="pdfjs"?`${P(N(PDFJS_URL))}web/viewer.html?file=${encodeURIComponent(o)}`:o}${B(r)}`,l=e==="pdfjs"||e==="iframe"?"iframe":"embed",t=document.createElement(l);return t.className="pdf-viewer",t.type="application/pdf",t.title=a,t.src=d,t instanceof HTMLIFrameElement&&(t.allow="fullscreen"),n.classList.add("pdf-viewer-container"),n.appendChild(t),n.getElementsByTagName(l)[0]},J=(e,n,{title:o,hint:r,options:a={},force:d})=>{if(!b(window)||!window.navigator?.userAgent)return null;const{navigator:l}=window,{userAgent:t}=l,s=S()||F(),i=!s&&L(),p=!s&&/firefox/iu.test(t)&&t.split("rv:").length>1?parseInt(t.split("rv:")[1].split(".")[0],10)>18:!1,w=l.pdfViewerEnabled||p,u=k(n);if(!u)return m("Target element cannot be determined"),null;const c=D(e)?e:__VUEPRESS_DEV__?null:`${window.origin}${e}`,g=o??/\/([^/]+).pdf/.exec(e)?.[1]??"PDF Viewer";return d?c?PDFJS_URL?h("pdfjs",u,e,a,g):(u.innerHTML=r.replace(/\[url\]/g,c),m("PDFJS URL is not defined"),null):(m("PDF link is not accessible."),null):w||!s?h(i?"iframe":"embed",u,e,a,g):PDFJS_URL&&c?h("pdfjs",u,e,a,g):(u.innerHTML=r.replace(/\[url\]/g,e),m("This browser does not support embedded PDFs"),null)};var V=T({name:"PDF",props:{url:{type:String,required:!0},title:String,width:{type:[String,Number],default:"100%"},height:[String,Number],ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,noFullscreen:Boolean,zoom:[String,Number],viewer:Boolean},setup(e){const{el:n,width:o,height:r,resize:a}=H(e),d=$(PDF_LOCALES),l=v(),t=v(),s=E(l),i=y(!1);return R(i,p=>{s.value=p}),U(()=>{l.value=document.body,J(M(e.url),t.value,{title:e.title,hint:d.value.hint,options:{page:e.page,noToolbar:e.noToolbar,...e.zoom&&e.zoom.toString()!=="100"?{zoom:e.zoom}:{}},force:e.viewer}),a()}),_(()=>{s.value=!1}),()=>f("div",{class:["pdf-viewer-wrapper",{fullscreen:i.value}],ref:n,style:i.value?{}:{width:o.value,height:r.value}},[f("div",{ref:t}),e.noFullscreen?null:f("button",{class:"pdf-fullscreen-button",onClick:()=>{i.value=!i.value}},f(i.value?z:I,{class:"pdf-fullscreen-icon"}))])}});export{V as default};
//# sourceMappingURL=PDF.js.map
